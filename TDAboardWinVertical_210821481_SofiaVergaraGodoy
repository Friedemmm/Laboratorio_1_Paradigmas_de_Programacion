; Descripción: Verificar si en una columna hay 4 piezas juntas del mismo color para ganar.
; Dom: Board (board).
; Rec: int (1 si gana jugador 1, 2 si gana jugador 2, 0 si no hay ganador vertical).
; Tipo recursión: Natural.

(require "TDAplayer_2108221481_SofiaVergara.rkt")

; Función para verificar victoria en una columna.
(define (board-check-vertical-win board)
  ; Función auxiliar para revisar una columna específica.
  (define (check-columna board columna)
    (if (= columna 7)
        0 ; Si no hay win, retorna 0.
        (if (= (check-4-piezas board columna 0) 0)
            (check-columna board (+ columna 1))
            (check-4-piezas board columna 0) ; Si hay, retornamos el ganador.
            )
        )
    )

  ; Función para ver que hayan 4 fichas juntas.
  (define (check-4-piezas board columna fila)
    (if (> (+ fila 3) 5) ; Si no hay espacio para 4 en vertical.
        0
        (if (and (list? (cierto-element (cierto-element board fila) columna))
                 (list? (cierto-element (cierto-element board (+ fila 1)) columna))
                 (list? (cierto-element (cierto-element board (+ fila 2)) columna))
                 (list? (cierto-element (cierto-element board (+ fila 3)) columna)))
            (if (and (equal? (first-element (cierto-element (cierto-element board fila) columna)) 
                             (first-element (cierto-element (cierto-element board (+ fila 1)) columna))
                             )
                     (equal? (first-element (cierto-element (cierto-element board fila) columna))
                             (first-element (cierto-element (cierto-element board (+ fila 2)) columna))
                             )
                     (equal? (first-element (cierto-element (cierto-element board fila) columna))
                             (first-element (cierto-element (cierto-element board (+ fila 3)) columna))
                             )
                     )
                (if (equal? (first-element (cierto-element (cierto-element board fila) columna)) "red")
                    1 ; Retorna 1 si es rojo.
                    2 ; Retorna 2 si es amarillo.
                    )
                (if (< fila 2)
                    (check-4-piezas board columna (+ fila 1))
                    0
                    )
                )
            (if (< fila 2)
                (check-4-piezas board columna (+ fila 1))
                0
                )
            )
        )
    )

  ; Iniciamos desde la columna 0.
  (check-columna board 0)
  )


